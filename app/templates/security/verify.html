{% extends "security/base.html" %}
{% from "_macros.html" import render_field_with_errors, render_field, prop_next %}

{% block before_security_card %}
  {% include "_messages.html" %}
{% endblock %}

{% block security_card %}
  <h5 class="card-title mb-4">Please Reauthenticate</h5>

  <div class="row mx-2">
    <p class="text-secondary">
      If authenticating with other platforms, please log out and log back in. Sorry for the inconvenience.
    </p>
  </div>

  <form action="{{ url_for_security("verify") }}{{ prop_next() }}" method="POST" name="verify_form">
    {{ verify_form.hidden_tag() }}

    <div class="row mx-2">
      {{ render_field_with_errors(verify_form.password, class='form-control w-100', placeholder='Password', autofocus=true) }}
    </div>

    <div class="row mx-2">
      {{ render_field(verify_form.submit, class='btn btn-primary w-100 mb-3') }}
    </div>
  </form>

  {% include "security/_menu.html" %}

{% endblock %}